<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Data Logging</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Marutpong Chailangka">
	<!-- <link href="bootswatch/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<link href="bootswatch/paper/bootstrap.min.css" rel="stylesheet">

	<!-- <link href="bootstrap-material-design/dist/css/material-fullpalette.min.css" rel="stylesheet"> -->
	<link rel="stylesheet" href="bootstrap-chosen/bootstrap.css" />
	<style>
	.top-buffer { margin-top:20px; }
	</style>
</head>
<body>

	<div class="container">


				<div class="row">
					<div class="col-lg-6 col-lg-offset-3 text-center">
						<h2 class="text-primary">Data Logging</h2>
					</div>
				</div>
				<form class="bs-component" action="show.html" method="GET" onsubmit="on_submit(event)" id="select_data_form">
					<div class="row">
						<div class="col-lg-6 col-md-6 col-lg-offset-3 col-md-offset-3">

							<!--<div class="form-group">
							<label class="control-label">select log</label>
							<div class="form-control-wrapper"><input class="form-control empty" id="name" name="name" type="text" style="cursor: auto;"><span class="material-input"></span></div>
							</div> -->
							<div class="row block">

								<div class="form-group hidden">
									<div class="col-lg-12">
										<select data-placeholder="choose data" multiple class="chosen-select" tabindex="8" name="name" id="chooser">
											<option value=""></option>
										</select>
									</div>
								</div>

								<div class="form-group top-buffer">
						      <label for="inputChannelID" class="col-lg-3 control-label">Channel ID</label>
						      <div class="col-lg-9">
						        <input type="text" class="form-control" name="channelID" id="inputChannelID" placeholder="Channel ID">
						      </div>
						    </div>

								<div class="form-group top-buffer">
						      <label for="inputReadAPIKey" class="col-lg-3 control-label">Read API Key</label>
						      <div class="col-lg-9">
						        <input type="text" class="form-control" name="api_key" id="inputReadAPIKey" placeholder="Read API Key">
						      </div>
						    </div>


								<div class="form-group top-buffer">
						      <label for="inputPassword" class="col-lg-3 control-label"></label>
						      <div class="col-lg-9">
						        <div class="checkbox">
						          <label>
						            <input type="checkbox" name="dynamic" checked="checked"> Dynamic Update
						          </label>
						        </div>
						      </div>
						    </div>


							</div>

							<!-- <div class="row block">
								<div class="form-group">
									<div class="col-lg-6 col-md-6">
										<div class="checkbox">
											<label>
												<input type="checkbox" name="average"><span class="checkbox-material"><span class="check"></span></span> Average sensor values by
											</label>
										</div>
									</div>
									<div class="col-lg-6 col-md-6">
										<select data-placeholder="choose log" class="form-control " name="by" style="height:36px;">
											<option value="10minute">10minute</option>
											<option value="hour">hour</option>
											<option value="day">day</option>
											<option value="month">month</option>
										</select>
									</div>
								</div>
							</div> -->

							<!-- <div class="row" style="display:none;">
								<div class="form-group">
									<div class="col-lg-6">
										<div class="checkbox">
											<label>
												<input type="checkbox" name="range"><span class="checkbox-material"><span class="check"></span></span> Range
											</label>
										</div>
									</div>
									<div class="col-lg-6">
										<select data-placeholder="choose log" class="form-control " name="date_range" style="height:36px;">
											<option value="10minute">10minute</option>
											<option value="hour">hour</option>
											<option value="day">day</option>
											<option value="month">month</option>
										</select>
									</div>
								</div>
							</div> -->
						<!--
						<div class="form-group">
						<div class="col-lg-10 col-lg-offset-4">
						<button type="submit" class="btn btn-primary">Submit</button>
						</div>
						</div>	-->
						</div>
						<div class="col-lg-1 col-md-1 col-sm-12 text-center">
						</div>
						</div>
						<div class="row text-center">
							<div class="col-lg-1 col-md-1 col-lg-offset-5 col-md-offset-5 block">
								<button class="btn btn-success" type="submit" id="btn_submit"><i class="mdi-navigation-arrow-forward"></i> Sumbit</button>
							</div>
						</div>
				</form>

	</div>

	<script src="bootswatch/bower_components/jquery/dist/jquery.min.js"></script>
	<script src="bootswatch/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- <script src="bootstrap-material-design/dist/js/material.min.js"></script> -->

	<!-- new -->
	<script src="bootstrap-chosen/chosen.jquery.js"></script>
	<script>
		$(function() {
			$('.container').height($(window).height());
		});

		function on_submit(event){

			if (!event.id){
				event.preventDefault();
			};
			//var data = $(event.target).serialize();
			var data = $('#select_data_form').serialize();
			var url = $(event.target).attr('action');
			var datas = data.split('&');
			var list = [];
			var is_avg = $('[name=average]').prop( "checked" );
			var by = $('[name=by]').val();
			var is_range = $('[name=range]').prop( "checked" );
			var date_range = $('[name=date_range]').val();

			var datas = {};
			$("#select_data_form").serializeArray().map(function(x){datas[x.name] = x.value;});

			if ( !Number(datas.channelID) || Number(datas.channelID)<1 ) {
				alert("Invalid Channel ID");
				return false;
			} else if ( datas.api_key && datas.api_key.length != 16 ) {
					alert("Invalid Read API Key");
					return false;
			} else {
				datas.dynamic = $('[name=dynamic]').prop( "checked" );
				var redirect = url+"?"+$.param(datas);//+"&average="+is_avg+"&by="+by+"&range="+is_range+"&date_range="+date_range;
				window.location.href = redirect;
			}
		}
	</script>
</body>
</html>
